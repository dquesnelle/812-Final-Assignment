---
title: "BIOL 812 Final Assignment - Report"
authors: "Isabella Asselstine, Xinran Li, Aakanx Panchal, Dan Quesnelle"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Data source: <https://www.ncbi.nlm.nih.gov/gene?term=nifH%5BGene%20Name%5D>

GitHub: <https://github.com/dquesnelle/812-Final-Assignment>

Group 1 - Isabella Asselstine, Xinran Li, Aakanx Panchal, Dan Quesnelle

All authors contributed to conceptualization, methodology, analysis and writing of the final report. Dan Quesnelle was responsible for data curation, Aakanx Panchal was responsible for the multiple sequence alignment code and visualizations, Xinran Li was responsible for the distance matrix code and visualizations, and Isabella Asselstine was responsible for the phylogenetic tree code and visualization.

\newpage

## Introduction

Nitrogen fixation is the process in which atmospheric nitrogen is converted into ammonia or other nitrogenous compounds in order to increase its reactive potential. Without the ability to fix nitrogen, the biosynthesis of nitrogen-containing macromolecule building blocks such as amino acids and nucleic acids would not be possible. This is because nitrogen in its atmospheric form is extremely stable and thus is largely unable to react with other elements to form compounds. Given the importance of nitrogen-containing compounds in the biosynthesis of plants, animals, and other organisms, the process of nitrogen fixation is essential to life.

Though nitrogen fixation can occur through inorganic means, the majority of nitrogen fixation is made possible by enzymes called nitrogenases. These enzymes are found in certain bacterial species and work by combining free nitrogen with other elements to form ammonia, nitrates, and nitrites, which may then be used in further reactions. Nitrogen-fixing bacteria often associate with plant roots where they are able to provide the plant with metabolically active nitrogen. These nitrogen-fixing microorganisms play an important role in nitrogen cycling as they are responsible for over 90% of all nitrogen fixation on earth (1).

Nitrogenases are encoded by a variety of nif genes. One such gene is nifH, which codes for one of the three nitrogenase subunits called dinitrogenase reductase. nifH is the choice genetic marker to search for when identifying nitrogen-fixing microorganisms. In our project, we will be looking at the alignment of nifH genes between a variety of bacterial species. Learning more about the conservation of nifH sequences is important when studying how nifH genes differ between bacterial species.

In our project, we wanted to explore two questions. Firstly, What interesting insights can we glean from an alignment, distance matrix, and phylogeny of 100 nifH gene sequences? Secondly, are there non-rhizobium nifH sequences that are closer to the nifH sequence of the model rhizobium Sinorhizobium meliloti 2011 than the nifH sequences of other rhizobia? To address these questions, we will look at the nifH gene from 100 bacterial species and compare their relatedness via a multiple sequence alignment, distance matrix, and a phylogenetic tree.

## Methods

NifH gene sequences from 100 different species of bacteria and archaea were collected from the NCBI Gene database. The gene IDs of the 100 gene sequences were compiled into a table along with other identifiers like gene and species name. To isolate the gene IDs from the other components of the table, we ran the file through a script that returns only the gene IDs in numeric form. It's in this form that we can use these gene IDs to retrieve the actual sequences. We took advantage of a command-line tool called Entrez Direct to retrieve our sequences. Entrez Direct is part of a larger tool called Entrez that is used for searching and fetching information from NCBI, and is one of the preferred methods for retrieval of genomic, coding and protein sequences (5). We ran the numeric array of gene IDs through an Entrez script that searched NCBI for each gene sequence, converted them to FASTA format and then outputted them to a file that would end up containing all 100 sequences.

The gene sequences were retrieved, converted into fasta format, and then aligned using the msa package for multiple sequence alignment in R. MView by Nigel Brown (2) was used to visualize our alignment; it added annotations including sequence sources (i.e., “Genus species strain”), percent coverage, percent identity, and colouring by properties such as mismatches relative to the reference sequence.

Before the visualization, we would like to remove sequences with large gaps to avoid numerical errors in later calculations. This was done through a Python script using a customized function named ratio_test. This script removed any sequences consisting of more than 60% gaps and generated a fasta (DMinput.fasta) file containing the remaining aligned sequences.

The preprocessed DMinput.fasta was then loaded as a DNAbin class through readDNAMultipleAlignment and as.DNAbin functions in R. This was followed by a transformation into a distance matrix. The distance matrix can be calculated using different models targeting different aspects of the data with different assumptions. The models we explored in this project were TS, TV, indel, JC69, K80, K81, and TN93. The tile plots for distance matrices were grouped by models and saved as “DistMat(TS&TV).pdf”, “DistMat(indel).pdf”, and “DistMat(JC69&K80&K81&TN93).pdf”.

We then wanted to create a phylogenetic tree to show the relatedness of our chosen bacterial species based on their nifH genes. To do this we took the distance matrix K80 that was previously calculated to create the tree. We used the ggtree package and created a circular tree with the bacterial genus and species names as labels. This was saved as “Phylogeny.pdf”. 


## References

1. Britannica, The Editors of Encyclopaedia. "nitrogen fixation". Encyclopedia Britannica, 9 Jul. 2021, https://www.britannica.com/science/nitrogen-fixation. Accessed 17 April 2022.
2. Brown, N.P., Leroy C., Sander C. (1998). MView: A Web compatible database search or multiple alignment viewer. Bioinformatics 14 (4):380--381.
3. Coyer JA, Cabello-Pasini A, Swift H, Alberte RS. 1996. N2 fixation in marine heterotrophic bacteria: dynamics of environmental and molecular regulation. Proc Natl Acad Sci U S A 93(8):3575-80.
4. Jukes, T. H. and Cantor, C. R. (1969) Evolution of protein molecules. in Mammalian Protein Metabolism, ed. Munro, H. N., pp. 21--132, New York: Academic Press.
5. Kans J. (2013) Entrez Direct: E-utilities on the Unix Command Line. In: Entrez Programming Utilities Help [Internet]. Bethesda (MD): National Center for Biotechnology Information (US); 2010-.
6. Kimura, M. (1980) A simple method for estimating evolutionary rates of base substitutions through comparative studies of nucleotide sequences. Journal of Molecular Evolution, 16, 111--120.
7. Kimura, M. (1981) Estimation of evolutionary distances between homologous nucleotide sequences. Proceedings of the National Academy of Sciences USA, 78, 454--458.
8. Tamura, K. and Nei, M. (1993) Estimation of the number of nucleotide substitutions in the control region of mitochondrial DNA in humans and chimpanzees. Molecular Biology and Evolution, 10, 512--526.
 
